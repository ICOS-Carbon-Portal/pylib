<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Modules - ICOS Carbon Portal pylib</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Modules";
        var mkdocs_page_input_path = "modules.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> ICOS Carbon Portal pylib
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">About</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../install/">Installation</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">Modules</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#dobj">Dobj</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#dobjinfo">Dobj.info</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#dobjmeta">Dobj.meta</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#dobjcitation">Dobj.citation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#dobjget_citationformat">Dobj.get_citation(format)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#dobjlicence">Dobj.licence</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#dobjprevious">Dobj.previous</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#dobjnext">Dobj.next</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#dobjcolnames">Dobj.colNames</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#dobjvariables">Dobj.variables</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#dobjdata">Dobj.data</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#dobjgetvariables">Dobj.get(variables)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#dobjgetcolumnsvariables">Dobj.getColumns(variables)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#dobjdatetimeconvert-true">Dobj.dateTimeConvert = True</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#dobjdobj-pid">Dobj.dobj = PID</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#dobjid-pid">Dobj.id = PID</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#dobjvalid">Dobj.valid</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#dobjlat">Dobj.lat</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#dobjlon">Dobj.lon</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#dobjelevation">Dobj.elevation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#dobjalt">Dobj.alt</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#dobjstation">Dobj.station</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#dobjsize">Dobj.size()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#station">Station</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#stationcountry">Station.country</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#stationdatalevelnone">Station.data(level=None)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#stationeag">Station.eag</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#stationeas">Station.eas</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#stationicosclass">Station.icosclass</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#stationfirstname">Station.firstName</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#stationlastname">Station.lastName</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#stationemail">Station.email</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#stationlat">Station.lat</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#stationlon">Station.lon</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#stationname">Station.name</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#stationproject">Station.project</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#stationstationid">Station.stationId</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#stationtheme">Station.theme</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#stationuri">Station.uri</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#stationvalid">Station.valid</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#convenience-functions">Convenience functions</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#stationgetidlist">station.getIdList()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#stationget">station.get()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#stationgetlist">station.getList()</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#collection">Collection</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#collectionid">Collection.id</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#collectiondoi">Collection.doi</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#collectioncitation">Collection.citation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#collectiontitle">Collection.title</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#collectiondescription">Collection.description</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#collectioninfo">Collection.info()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#collectiondatalink">Collection.datalink</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#collectiondata">Collection.data</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#collectiongetcitation">Collection.getCitation()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#convenience-functions_1">Convenience functions</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#collectiongetidlist">collection.getIdList()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#collectionget">collection.get()</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#stilt">STILT</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#stiltstation">stiltstation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#findkwargs">.find(**kwargs)</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#idstr-strstr">id='STR' | ['STR','STR',...]</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#searchstr">search='STR'</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#stationsdict">stations=DICT</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#countrystr-strstr">country='STR' | ['STR','STR',...]</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#projecticos">project='icos'</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#bboxlatlonlatlon">bbox=[(lat,lon),(lat,lon)]</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#pinpointlatlondistancekm">pinpoint=[lat,lon,distanceKM]</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#sdatestart-date">sdate='start date'</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#edateend-date">edate='end date'</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#dates">dates=[]</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#progress-bool">progress = BOOL</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#outfmt-str">outfmt = 'STR'</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#getid-progressfalse">.get(id='', progress=False)</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#id-str-liststr">id = STR | LIST[STR]</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#id-dict-listdict">id = DICT | LIST[DICT]</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#progress-bool_1">progress = BOOL</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#stilt-object">STILT Object</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#id">.id</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#locident">.locIdent</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#alt">.alt</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#lat">.lat</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#lon">.lon</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#name">.name</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#icos">.icos</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#years">.years</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#info">.info</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#geoinfo">.geoinfo</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#get_tsstart_date-end_date-hours-columns">.get_ts(start_date, end_date, hours=[], columns=''):</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#get_fpstart_date-end_date-hours">.get_fp(start_date, end_date, hours=[]):</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#sparql">Sparql</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#runsparqldata">RunSparql.data</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#runsparqlquery-query">RunSparql.query = 'query'</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#runsparqlformat-fmt">RunSparql.format = 'fmt'</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#runsparqlrun">RunSparql.run()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#country">Country</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#countrygetkwargs">country.get(**kwargs)</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#parameters">Parameters</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#returns">Returns</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../examples/">Examples</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../faq/">FAQ</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../changelog/">Changelog</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">ICOS Carbon Portal pylib</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li><li>Modules</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>

          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="content">Content</h1>
<p>The following modules are available in the library to find and access data hosted at the Carbon Portal. After a successful installation into your python environment you should be able to load the modules with:</p>
<ul>
<li><code>from icoscp.cpb.dobj import Dobj</code></li>
<li><code>from icoscp.station import station</code></li>
<li><code>from icoscp.collection import collection</code></li>
<li><code>from icoscp.stilt import stiltstation</code></li>
<li><code>from icoscp.sparql.runsparql import RunSparql</code></li>
<li><code>from icoscp.sparql import sparqls</code></li>
</ul>
<h2 id="dobj">Dobj</h2>
<p>This is the basic module to load a <strong>d</strong>igital <strong>obj</strong>ect (data set) into memory. You need to know a valid persistent identifier (PID/URL) to access the data. Either you can browse the <a href="https://data.icos-cp.eu">data portal</a> to find PID's or you can use the 'station' package to find PID's programmatically (see section <a href="#station">station</a>). In essence each data object is linked to a unique and persistent identifier in the form of a URL. Hence, each data object has an on-line landing page. If you select any data object on <a href="https://data.icos-cp.eu">https://data.icos-cp.eu</a> and then navigate to the PID link (which looks like <code>11676/j7-Lxlln8_ysi4DEV8qine_v</code> ) you end up on the 'landing' page of the document. If you look at the address bar of your browser, you will see a URL similar to <a href="https://meta.icos-cp.eu/objects/j7-Lxlln8_ysi4DEV8qine_v">https://meta.icos-cp.eu/objects/j7-Lxlln8_ysi4DEV8qine_v</a>. To access the data you need to know this URL or the last part of the URL (<code>j7-Lxlln8_ysi4DEV8qine_v</code>).</p>
<p>Load the module with:</p>
<pre><code>from icoscp.cpb.dobj import Dobj
</code></pre>
<p>classmethod <strong>Dobj(digitalObject='')</strong><br>
You can initialise a Dobj with a PID. The following statements yield the same result.</p>
<pre><code>myDobj = Dobj('https://meta.icos-cp.eu/objects/j7-Lxlln8_ysi4DEV8qine_v')
myDobj = Dobj('11676/j7-Lxlln8_ysi4DEV8qine_v')
myDobj = Dobj('j7-Lxlln8_ysi4DEV8qine_v')
</code></pre>
<p>or create an 'empty' instance and the set the identifier later:</p>
<pre><code>myDobj = Dobj()
myDobj.dobj = "j7-Lxlln8_ysi4DEV8qine_v"
</code></pre>
<h2>Attributes:</h2>
<h3 id="dobjinfo"><strong>Dobj.info</strong></h3>
<p><strong> Please refer to the property <code>.meta</code></strong>. The property <code>.info</code> returns now the same as <code>.meta</code> which was introduced with version 0.1.15.</p>
<p>For provenance reasons only the following documentation is kept, but is only valid for installations 0.1.10 to 0.1.14:</p>
<pre><code>All Dobj related metadata is available in the following properties.
This will return a list of three Pandas DataFrames which contain metadata.

info[0] -&gt; information about the dobj like, url, specification,
        number of rows, related file name.
info[1] -&gt; information about the data like colName,
        value type, unit, kind
info[2] -&gt; information about the station, where the data was obtained.
        Name, id, lat, lon etc..

- Return LIST[Pandas DataFrame]
</code></pre>
<h3 id="dobjmeta"><strong>Dobj.meta</strong></h3>
<p>This property was introduced with version 0.1.15 and is replacing <strong>.info</strong>.<br>
.meta returns a dictionary based on the meta data available from the landing page of the ICOS Caronb Portal website. Every data object has a rich set of meta data available. You can download an example from data portal:<a href="https://meta.icos-cp.eu/objects/M8STRfcQfU4Yj7Uy0snHvlve/meta.json">https://meta.icos-cp.eu/objects/M8STRfcQfU4Yj7Uy0snHvlve/meta.json</a>. This will then be parsed into a python dictionary representing the metadata from ICOS.
Some of the important key properties, like 'previous', 'next', 'citation', etc., are extracted for easy access and made available as properties. Please check this documentation.</p>
<h3 id="dobjcitation"><strong>Dobj.citation</strong></h3>
<p>Citation string, a simple plain text citation string.</p>
<ul>
<li>Return STR</li>
</ul>
<h3 id="dobjget_citationformat"><strong>Dobj.get_citation(format)</strong></h3>
<p>Returns the citation string in different formats. By default a plain formatted string is returned, the same as with with the property <code>Dobj.citation</code>. Possible formats are:</p>
<ul>
<li><strong>plain</strong> : (default) a simple string</li>
<li><strong>bibtex</strong> : <a href="https://en.wikipedia.org/wiki/BibTeX">wikipedia</a></li>
<li><strong>ris</strong> : <a href="https://en.wikipedia.org/wiki/RIS_(file_format)">wikipedia</a></li>
</ul>
<p>Example: Dobj.get_citation('ris')</p>
<h3 id="dobjlicence"><strong>Dobj.licence</strong></h3>
<p>Licence associated with the dataset.</p>
<ul>
<li>
<p>Return DICT</p>
<p>dict_keys(['baseLicence', 'name', 'url', 'webpage'])</p>
</li>
</ul>
<h3 id="dobjprevious"><strong>Dobj.previous</strong></h3>
<p>If an older version of this data object is available, this returns the <strong>pid</strong> for this object.</p>
<ul>
<li>Return STR</li>
</ul>
<h3 id="dobjnext"><strong>Dobj.next</strong></h3>
<p>If a newer version of the data object is available, this returns the <strong>pid</strong> for this object.</p>
<ul>
<li>Return STR</li>
</ul>
<h3 id="dobjcolnames"><strong>Dobj.colNames</strong></h3>
<p>Available column names. This information is part of the <code>Dobj.meta</code>, which holds all the 
available metadata.</p>
<ul>
<li>Return LIST</li>
</ul>
<h3 id="dobjvariables"><strong>Dobj.variables</strong></h3>
<p>This provides access to all available variables, including the unit, a short description (type) and the 'landing page' for the format used (int, float, chr, ...). The following example shows the variables for a data object of an atmospheric methane concentration:</p>
<table>
<thead>
<tr>
<th>index</th>
<th>name</th>
<th>unit</th>
<th>type</th>
<th>format</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>TIMESTAMP</td>
<td>None</td>
<td>time instant, UTC</td>
<td>http://meta.icos-cp.eu/ontologies/cpmeta/iso8601dateTime</td>
</tr>
<tr>
<td>1</td>
<td>Flag</td>
<td>None</td>
<td>quality flag</td>
<td>http://meta.icos-cp.eu/ontologies/cpmeta/bmpChar</td>
</tr>
<tr>
<td>2</td>
<td>NbPoints</td>
<td>None</td>
<td>number of points</td>
<td>http://meta.icos-cp.eu/ontologies/cpmeta/int32</td>
</tr>
<tr>
<td>3</td>
<td>ch4</td>
<td>nmol mol-1</td>
<td>CH4 mixing ratio (dry mole fraction)</td>
<td>http://meta.icos-cp.eu/ontologies/cpmeta/float32</td>
</tr>
<tr>
<td>4</td>
<td>Stdev</td>
<td>nmol mol-1</td>
<td>standard deviation of gas mole fraction</td>
<td>http://meta.icos-cp.eu/ontologies/cpmeta/float32</td>
</tr>
</tbody>
</table>
<ul>
<li>Return Pandas DataFrame</li>
</ul>
<h3 id="dobjdata"><strong>Dobj.data</strong></h3>
<p>Retrieve the actual data for the PID. All available variables will be returned.</p>
<ul>
<li>Return Pandas DataFrame</li>
</ul>
<h3 id="dobjgetvariables"><strong>Dobj.get(variables)</strong></h3>
<p>Retrieve the actual data for the PID. The same as <code>.data</code> but you have the option to retrieve only selected columns (or variables). Only valid and unique entries will be returned. You can see valid entries with <a href="#dobjvariables">.variables['name']</a> or <a href="#dobjcolnames">.colNames</a>. If columns are not provided, or if none of the provided variables are valid, or if you work with local data, the default DataFrame (with all columns) will be returned, which is the same as <code>.data</code>. </p>
<ul>
<li>Parameter variables: LIST[STR]</li>
<li>Return Pandas DataFrame</li>
</ul>
<h3 id="dobjgetcolumnsvariables"><strong>Dobj.getColumns(variables)</strong></h3>
<p>This is exactly the same as <code>.get()</code>. See details above. We keep this for backward compatibility,  please do not use. This function will be deprecated over time.</p>
<p><strong> Examples to retrieve data</strong>:</p>
<pre><code># Create a dobj:

do = Dobj('https://meta.icos-cp.eu/objects/9GVNGXhqvmn7UUsxSWp-zLyR')

# Access all data, or specific columns:

data = do.data                                  # all data is returned&lt;br&gt;
data = do.get(['timestamp','ch4'])              # only timestamp and ch4 is returned&lt;br&gt;
data = do.get(['timestamp','ch4','notValid'])   # only timestamp and ch4 is returned&lt;br&gt;
data = do.get()                                 # all data is returned&lt;br&gt;
</code></pre>
<h3 id="dobjdatetimeconvert-true"><strong>Dobj.dateTimeConvert = True</strong></h3>
<p>Set or retrieve. Default <strong>True</strong>. The binary data representation provides a UTC Timestamp as 
Unixtimestamp with start point of 1970-01-01 00:00:00. By default, this is converted to a DateTimeObject
(<strong>pandas._libs.tslibs.timestamps.Timestamp</strong>). If you prefer to have the raw Unixtimestamp 
(<strong>numpy.float64</strong>), set Dobj.dateTimeConvert = False prior to load the data with <strong>.get()</strong> or <strong>.data</strong> or <strong>.getColumns()</strong>.</p>
<ul>
<li>Return BOOL</li>
</ul>
<h3 id="dobjdobj-pid"><strong>Dobj.dobj = PID</strong></h3>
<p>See Dobj.id</p>
<h3 id="dobjid-pid"><strong>Dobj.id = PID</strong></h3>
<p>Set or retrieve the PID for the Dobj, default is empty (""). If a PID is set, an automatic 
check is performed to find the metadata for the object. If this is successful, the 'valid' 
property is set to <strong>True</strong></p>
<ul>
<li>Return STR</li>
</ul>
<h3 id="dobjvalid"><strong>Dobj.valid</strong></h3>
<p>True if PID is set and found at the ICOS Carbon Portal</p>
<ul>
<li>Return BOOL</li>
</ul>
<h3 id="dobjlat"><strong>Dobj.lat</strong></h3>
<p>Latitude for station</p>
<ul>
<li>Return FLOAT</li>
</ul>
<h3 id="dobjlon"><strong>Dobj.lon</strong></h3>
<p>Longitude for station</p>
<ul>
<li>Return FLOAT</li>
</ul>
<h3 id="dobjelevation"><strong>Dobj.elevation</strong></h3>
<p>Elevation above sea level for station. Be aware, this is NOT the sampling height for the data
points.</p>
<ul>
<li>Return FLOAT</li>
</ul>
<h3 id="dobjalt"><strong>Dobj.alt</strong></h3>
<p>This is exactly the same as .elevation</p>
<h3 id="dobjstation"><strong>Dobj.station</strong></h3>
<p>This returns information about the station, where the data was collected/measured, to provide information about the provenance of the data. Further information about sammplingHeight, instruments, documentation, etc. can be found in <code>dobj.meta['specificInfo']['acquisition']</code>.
Please be aware that prior to version 0.1.15 this has returned a string with station id, which is now available as station['id']. An example code snippet on how to extract all 'keys' from a nested dictionary is available in the <a href="../faq/#q1">FAQ</a></p>
<ul>
<li>Return DICT</li>
</ul>
<h3 id="dobjsize"><strong>Dobj.size()</strong></h3>
<p>The real size of the dobj in [bytes, KB, MB, TB]. Since this object may contain the data, it is 
no longer just a pointer to data.</p>
<ul>
<li>Return TUPLE (int32, STR), where int32 represents the size and STR the unit. Example output 
  looks like: (4.353, 'MB')</li>
</ul>
<hr>
<h2 id="station">Station</h2>
<p>The station module provides a search facility to explore ICOS stations and find associated data 
objects and data products. There is a lot of information available about the ICOS stations, 
partner countries, measured variables and much more in the 
<a href="https://www.icos-cp.eu/sites/default/files/2022-03/ICOS_Handbook_2022_web.pdf">ICOS Handbook</a>.
load the module with:</p>
<pre><code>from icoscp.station import station
</code></pre>
<p>classmethod <strong>station.Station()</strong><br>
The station object is primarily a data structure to store the associated metadata. The metadata 
is provided with specific and complex Sparql queries. It is possible to instantiate this 
class on its own, but we recommend using the convenience functions <code>station.getIdList()</code> 
<code>station.get('StationID')</code> <code>station.getList()</code>  as described further below to create the 
station object. Once you have a created valid station object a list of attributes are available:</p>
<hr><h2>Attributes:</h2>
<hr>

<h3 id="stationcountry"><strong>Station.country</strong></h3>
<p>Country code</p>
<ul>
<li>Return STR</li>
</ul>
<h3 id="stationdatalevelnone"><strong>Station.data(level=None)</strong></h3>
<p>All associated data object for the station are returned. ICOS distinguishes data in terms of 
how processed they are.</p>
<pre><code>- Data level 1: Near Real Time Data (NRT) or Internal Work data (IW).
- Data level 2: The final quality checked ICOS RI data set, published by the CFs, 
                to be distributed through the Carbon Portal. 
                This level is the ICOS-data product and free available for users.
- Data level 3: All kinds of elaborated products by scientific communities
                that rely on ICOS data products are called Level 3 data.
</code></pre>
<ul>
<li>Return Pandas DataFrame</li>
</ul>
<h3 id="stationeag"><strong>Station.eag</strong></h3>
<p>Elevation above <strong>ground</strong>, if available. Please note, this is general information about the 
height of the tower. This is NOT a sampling height, and it is not guaranteed to be accurate.</p>
<ul>
<li>Return FLOAT</li>
</ul>
<h3 id="stationeas"><strong>Station.eas</strong></h3>
<p>Elevation above <strong>sea level</strong> in meter.</p>
<ul>
<li>Return FLOAT</li>
</ul>
<h3 id="stationicosclass"><strong>Station.icosclass</strong></h3>
<p>Classification for certified ICOS stations. Please consult the 
<a href="https://www.icos-cp.eu/sites/default/files/cmis/ICOS%20Handbook%202020.pdf">ICOS Handbook</a> for 
further information about the Class 1&amp;2 certificate.</p>
<ul>
<li>Return STR</li>
</ul>
<h3 id="stationfirstname"><strong>Station.firstName</strong></h3>
<p>PI (Principal Investigator) First Name.</p>
<ul>
<li>Return STR</li>
</ul>
<h3 id="stationlastname"><strong>Station.lastName</strong></h3>
<p>PI (Principal Investigator) last name</p>
<ul>
<li>Return STR</li>
</ul>
<h3 id="stationemail"><strong>Station.email</strong></h3>
<p>PI (Principal Investigator) email address</p>
<ul>
<li>Return STR</li>
</ul>
<h3 id="stationlat"><strong>Station.lat</strong></h3>
<p>Latitude for the station.</p>
<ul>
<li>Return FLOAT</li>
</ul>
<h3 id="stationlon"><strong>Station.lon</strong></h3>
<p>Longitude for the station.</p>
<ul>
<li>Return FLOAT</li>
</ul>
<h3 id="stationname"><strong>Station.name</strong></h3>
<p>Returns the full name for the station.</p>
<ul>
<li>Return STR</li>
</ul>
<h3 id="stationproject"><strong>Station.project</strong></h3>
<p>ICOS Carbon Portal is a data portal from and for the ICOS community. However, the data portal 
does host more than ICOS data. The station association is listed here (if available)</p>
<ul>
<li>Return LIST</li>
</ul>
<h3 id="stationstationid"><strong>Station.stationId</strong></h3>
<p>Set or retrieve the StationId </p>
<ul>
<li>Return STR</li>
</ul>
<h3 id="stationtheme"><strong>Station.theme</strong></h3>
<p>For ICOS stations a 'theme' is provided. Please note that, a station may belong to more than 
one theme, but with different themes. For example the stationId "NOR" (Norunda, Sweden), will 
give you access to the atmospheric data products, whereas the stationId "SE-Nor" will return 
the Ecosystem data products.</p>
<pre><code>AS for Atmospheric Stations
ES for Ecosystem Stations
OS for Ocean Stations
</code></pre>
<ul>
<li>Return STR</li>
</ul>
<h3 id="stationuri"><strong>Station.uri</strong></h3>
<p>Link to the landing page for the station. Because a station ID may be associated with more than 
one 'project' this returns a list of URI's</p>
<ul>
<li>Return LIST</li>
</ul>
<h3 id="stationvalid"><strong>Station.valid</strong></h3>
<p>True if stationId is found.</p>
<ul>
<li>Return BOOL</li>
</ul>
<h3 id="convenience-functions"><strong>Convenience functions</strong></h3>
<p>The following three functions are recommended to get information about the available 
stations at the Carbon Portal and how to get a valid station object (or list of):</p>
<h4 id="stationgetidlist">station.getIdList()</h4>
<pre><code>station.getIdList(project='ICOS', sort='name')
</code></pre>
<p>This returns a DataFrame with columns:</p>
<p><code>['uri', 'id', 'name', 'country', 'lat', 'lon', 'elevation', 'project', 'theme']</code></p>
<p>By default, ICOS certified stations are returned. If project is set to 'all', all known 
stations (to the Carbon Portal) are returned. By default, the DataFrame is sorted by name. You 
can provide any column name as sorting parameter. The 'id' of the record, can be used to 
instantiate  a station. Hence, it is easy to adjust and filter these records and use the column 
'id' as input for station.get()</p>
<ul>
<li>Return Pandas DataFrame  </li>
</ul>
<pre><code>station.getIdList(project='ALL', outfmt='map', icon=None)
</code></pre>
<p>If the optional argument <code>outfmt='map'</code> is provided, a folium map is created with all the queried 
stations provided by the <code>project</code> argument. Stations without a fixed location (like 
measurements collected from instrumented Ships of Opportunity) will not be included in the map. 
Each marker in the map represents a station and contains station related information. A user can
further customize the style of the map by providing the <code>icon</code> argument <code>[None, 'flag', 'path/to/image.png']</code>.</p>
<ul>
<li>Return Folium Map</li>
</ul>
<h4 id="stationget">station.get()</h4>
<pre><code>station.get('stationID')
</code></pre>
<p>Provide a valid station id (see getIdList()) to create a Station object. NOTE: stationId is 
CaseSensitive.</p>
<ul>
<li>Return Station Object</li>
</ul>
<h4 id="stationgetlist">station.getList()</h4>
<pre><code> station.getList(theme=['AS','ES','OS'], ids=None)
</code></pre>
<p>This is the easiest way to get a list of ICOS stations. By default, a full list of all 
certified ICOS stations is returned. You can filter the output by provided a list of themes OR 
you can provide a list of station id's. NOTE: If you provide a list of id's, the theme filter 
is ignored. </p>
<pre><code>station.getList(['as', 'os'])
</code></pre>
<p>list with ICOS atmospheric and ocean stations</p>
<pre><code>station.getList(ids=['NOR', 'HTM', 'HUN'])
</code></pre>
<p>list with stations NOR (Norunda), HTM (Hyltemossa), HUN (Hegyhatsal)</p>
<ul>
<li>Return LIST[Station Objects]</li>
</ul>
<hr>
<h2 id="collection">Collection</h2>
<p>This module supports to load a collection of digital objects. Data products 
(<a href="https://www.icos-cp.eu/data-products">https://www.icos-cp.eu/data-products</a>) or collections 
are an assembly for a specific theme, or project. For example the ICOS community assembled data 
to provide a base for the Drought anomaly in 2018. This dataset was then used to study the 
impact of this extreme event, which ultimately led to a series of publications available as 
'theme issue' in <a href="https://royalsocietypublishing.org/toc/rstb/2020/375/1810">The Royal Society</a>.
Subsequently, the data sets are now public available at the ICOS Carbon Portal 
(<a href="https://www.icos-cp.eu/data-products/YVR0-4898">Drought-2018 ecosystem eddy covariance flux product for 52 stations</a> and 
<a href="https://www.icos-cp.eu/data-products/ERE9-9D85">Drought-2018 atmospheric CO2 Mole Fraction product for 48 stations (96 sample heights)</a>. <br></p>
<p>Load the module with:<br>
    from icoscp.collection import collection</p>
<p>classmethod <strong>Collection(coll)</strong><br>
(where <code>coll</code> represents a <code>pandas.DataFrame</code>, similar to the output from .getIdList()). BUT 
only similar. We do <strong>NOT Recommend</strong> to instantiate this class directly. Please <strong>use</strong> the 
function <strong>.get(CollectionId)</strong>. The Purpose of the class documentation is to provide you a 
list of attributes available, after the .get(CollectionId) return a collection object.</p>
<hr><h2>Attributes:</h2>
<hr>

<h3 id="collectionid"><strong>Collection.id</strong></h3>
<p>This is the ICOS URI (PID). A link to the landing page on the ICOS data portal.</p>
<ul>
<li>Return STR</li>
</ul>
<h3 id="collectiondoi"><strong>Collection.doi</strong></h3>
<p>If available, the official DOI in form of '10.18160/ry7n-3r04'.</p>
<ul>
<li>Return STR</li>
</ul>
<h3 id="collectioncitation"><strong>Collection.citation</strong></h3>
<p>For convenience the citation string provided from [https://citation.crosscite.org/] is stored 
in this attribute. If you like to have a different format, please have a look at .getCitation 
description below.</p>
<ul>
<li>Return STR</li>
</ul>
<h3 id="collectiontitle"><strong>Collection.title</strong></h3>
<ul>
<li>Return STR</li>
</ul>
<h3 id="collectiondescription"><strong>Collection.description</strong></h3>
<ul>
<li>Return STR</li>
</ul>
<h3 id="collectioninfo"><strong>Collection.info()</strong></h3>
<p>For convenience all the attributes above <code>(id, doi, citation, title, description)</code>. You can 
choose the output format with fmt=["dict" | "pandas" | "html"]. The default is "dict".</p>
<pre><code>info(self, fmt='dict')
</code></pre>
<ul>
<li>Return FMT, default DICT</li>
</ul>
<h3 id="collectiondatalink"><strong>Collection.datalink</strong></h3>
<p>This returns a list of PID/URI of digital objects associated with the collection.</p>
<ul>
<li>Return LIST[STR]</li>
</ul>
<h3 id="collectiondata"><strong>Collection.data</strong></h3>
<p>This returns a list of Dobj associated to the collection. Please refer to the module Digital
Object above.</p>
<ul>
<li>Return LIST[Dobj]</li>
</ul>
<h3 id="collectiongetcitation"><strong>Collection.getCitation()</strong></h3>
<pre><code>Collection.getCitation(format='apa', lang='en-GB')**
</code></pre>
<p>If the collection has a DOI, you will get a citation string from 
<a href="https://citation.crosscite.org/">https://citation.crosscite.org/</a>. You may provide any style &amp; 
language parameters found on the website. Our default style is <em>apa</em> and language <em>en-GB</em>, 
which  is stored in the attribute <code>collection.citation</code>. Use the function getCitation(), if you 
need a specific format &amp; language adaption. Example to get a Bibtex styled citation:
<code>.getCitation('bibtex','de-CH')</code></p>
<h3 id="convenience-functions_1"><strong>Convenience functions</strong></h3>
<p>The following functions are recommended to get information about the available collections as 
well  as creating an instance of a collection.</p>
<h4 id="collectiongetidlist">collection.getIdList()</h4>
<pre><code>collection.getIdList()
</code></pre>
<p>This will return a <code>pandas.DataFrame</code>, listing all available collections at the data portal. The 
DataFrame contains the following columns: 
<code>['collection', 'doi', 'title', 'description', 'dobj', 'count']</code>. We would recommend that you 
pay close attention to the <code>count</code>. We have collections with many data objects associated. If 
you just want to play around, select a collection with less than 10 objects.</p>
<ul>
<li><code>collection</code> contains the PID/URI for the collection. This is the ID you need to provide for 
the .get(CollectionId) function. Please be aware that you need to provide the full URI.<br>
Example: .get('https://meta.icos-cp.eu/collections/n7cIMHIyqHJKBeF_3jjgptHP')</li>
<li><code>dobj</code> contains a list (LIST[STR]) of all PID/URI associated data objects.<br></li>
<li><code>count</code> tells you how many data objects are associated with this collection.
<br><br></li>
<li>Returns a pandas DataFrame </li>
</ul>
<h4 id="collectionget">collection.get()</h4>
<pre><code>collection.get(CollectionId)
</code></pre>
<p>Create a collection object. See the class method above for the attributes available in the 
collection object. The <code>CollectionId</code> must be either the full ICOS URI of the collection 
landing page or the DOI (if one is available). Not all collections have a DOI. Both information 
can be extracted with the function .getIdList() .The following to lines to create 
'myCollection' yield the <strong>same result</strong>:</p>
<pre><code>myCollection = get('https://meta.icos-cp.eu/collections/n7cIMHIyqHJKBeF_3jjgptHP')
myCollection = get('10.18160/ry7n-3r04')
</code></pre>
<ul>
<li>Returns Collection</li>
</ul>
<hr>

<h2 id="stilt">STILT</h2>
<p>At the ICOS Carbon Portal we offer a service to calculate your own STILT footprints and 
visualize the results. Find out more on our website
<a href="https://www.icos-cp.eu/data-services/tools/stilt-footprint">https://www.icos-cp.eu/data-services/tools/stilt-footprint</a>. The calculated footprints and time 
series results are also available through this python library. Please be aware, that the 
calculated <strong>footprints are only available on our servers</strong>, including our virtual 
computational environments. Please read about our public available Jupyter Hub 
<a href="https://icos-carbon-portal.github.io/jupyter/">here</a>. Time series can be accessed from outside 
our servers as well.</p>
<p>load the module with:</p>
<pre><code>from icoscp.stilt import stiltstation
</code></pre>
<p>Two functions are available: one to find STILT stations and one to extract the STILT station as 
an object, which gives access to the data (time series and footprints).</p>
<h3 id="stiltstation">stiltstation</h3>
<h3 id="findkwargs">.find(**kwargs)</h3>
<p>This is the main function to find STILT stations. By default, it returns a dictionary where each 
station id is the key to access metadata about the station. The order how you provide keywords 
is respected and you can influence the result. Keyword arguments are applied sequentially (the 
result from the first keyword is provided as input to the second and so on). With no keyword 
provided <code>stiltstation.find()</code> returns a dictionary with ALL Stilt stations.</p>
<p>The following keywords are available:</p>
<h5 id="idstr-strstr">id='STR' | ['STR','STR',...]</h5>
<p>Provide a single id as string, or a list of strings.<br>You can provide either STILT or ICOS 
id's mixed together.</p>
<pre><code>stiltstation.find(id=['NOR', 'GAT344'])
stiltstation.find(id='KIT030')
</code></pre>
<h5 id="searchstr">search='STR'</h5>
<p>Arbitrary string search will find any occurrence of STR in the station metadata.</p>
<pre><code>stiltstation.find(search='south')
</code></pre>
<h5 id="stationsdict">stations=DICT</h5>
<p>all actions are performed on this dictionary, rather than dynamically search for all stilt 
station on our server. Can be useful for creating a subset of stations from an existing search.</p>
<pre><code>myStations = stiltstation.find(search='north')
refined = stiltstation.find(stations=myStations, country='Finland')
</code></pre>
<p><br><h2>Spatial keywords</h2><br></p>
<h5 id="countrystr-strstr">country='STR' | ['STR','STR',...]</h5>
<p>Provide a single country id as string, or a list of strings. You can provide alpha-2, alpha-3 
code (ISO 3166) or the full country name (some translations are available as well). To find all 
STILT stations with geolocation in Norway you can search for either NO, NOR, Norway, Norge.</p>
<pre><code>stiltstation.find(country=['Swe','norge', 'IT'])
</code></pre>
<h5 id="projecticos">project='icos'</h5>
<p>This option will retrieve all STILT stations that are ICOS stations.</p>
<h5 id="bboxlatlonlatlon">bbox=[(lat,lon),(lat,lon)]</h5>
<p>Bounding Box. Provide two tuples (wgs84), where the box is defined as TopLeftCorner (NorthWest) 
and BottomRightCorner (SouthEast). The following example returns approximately all stations in 
Scandinavia.</p>
<pre><code>stiltstation.find(bbox=[(70,5),(55,32)])
</code></pre>
<h5 id="pinpointlatlondistancekm">pinpoint=[lat,lon,distanceKM]</h5>
<p>Provide a single point (lat, lon) and the Distance in KM, which creates a bounding box. 
Distance is very roughly translated with 1 degree = 1 km. The bounding box is calculated as 
distance in all directions. For example <code>distance=200</code> will create a bounding box of 400 x 400 
km with pinpoint in the centre. If you don't provide a distance, a default value of 200 is used.</p>
<pre><code>stiltstation.find(pinpoint=[55.7,13.1,500])     # bounding box ~ 1000km x 1000km
stiltstation.find(pinpoint=[55.7,13.1])         # bounding box ~ 400km x 400km
</code></pre>
<p><br><h2>Temporal keywords</h2><br></p>
<p>Be aware, that the granularity for all temporal keywords is year and month, days are not 
considered in the search. Input format for the dates entry MUST be convertible to data time 
object through pandas.to_datetime().  Accepted formats are:</p>
<ul>
<li>datetime.date objs</li>
<li>FLOAT or INT representing a unix timestamp (seconds since 1970-01-01)</li>
<li>pandas.datetime</li>
<li>STR: "YYYY-MM-DD" , "YYYY", "YYYY/MM/DD"</li>
</ul>
<h4 id="sdatestart-date">sdate='start date'</h4>
<p>Stations are returned where results are available for &gt;= start date. 'sdate' is a single entry. 
If you provide sdate AND edate, any station with available data within that date range is 
returned. (accepted formats see above)</p>
<pre><code>stiltstation.find(sdate= '2018-05-01')
</code></pre>
<h4 id="edateend-date">edate='end date'</h4>
<p>Stations are returned where results are available for &lt;= end date. 'edate' is a single entry. 
If you provide sdate AND edate, any station with available data within that date range is 
returned. (accepted formats see above)</p>
<pre><code>stiltstation.find(edate='2018-06-01')
</code></pre>
<h4 id="dates">dates=[]</h4>
<p>This will return a list of stations where data is available for any of the provided dates. 
Input format, see sdate,edate. Remember, that only year and month is checked.</p>
<pre><code>stiltstation.find(dates=['2020-01-01', '2020/05/23'])
</code></pre>
<h4 id="progress-bool">progress = BOOL</h4>
<p>By default a progress bar is displayed while searching all possible STILT stations. With this keyword you can show/hide the progress bar.</p>
<pre><code>stiltstation.find(progress=True)   # DEFAULT, progress bar is displayed
stiltstation.find(progress=False)  # No progress bar
</code></pre>
<h4 id="outfmt-str">outfmt = 'STR'</h4>
<p>where string is <code>dict</code> | <code>pandas</code> | <code>list</code> | <code>map</code> | <code>avail</code>.
This keyword is ALWAYS executed last, regardless of the position within keyword arguments. By 
default, a <code>dictionary</code> is returned. With <code>pandas</code> a pandas DataFrame is returned where the 
station id is indexed, each row contains one station with the same metadata as is available in 
the dictionary <a href="https://pandas.pydata.org/docs/">https://pandas.pydata.org/docs/</a>. List however 
returns a list of STILT station objects. Please see the documentation about<br>
<code>stiltstation.get(id="")</code>. The choice <code>map</code>, returns a folium map 
<a href="https://python-visualization.github.io/folium/">https://python-visualization.github.io/folium/</a>.
The map can be displayed directly in a Jupyter Notebook, or you can save the map to a html file.</p>
<pre><code>stiltstation.find(country='Italy', outfmt='pandas') 
stiltstation.find(country='Italy', outfmt='pandas').save('mymap.html')
</code></pre>
<p>Finally, the choice <code>avail</code> will return a pandas DataFrame where availability of timeseries data 
per STILT station is gathered for each year. </p>
<h3 id="getid-progressfalse">.get(id='', progress=False)</h3>
<p>Returns a stilt station object or a list of stilt station objects. A stilt station object, 
gives access to the underlying data (timeseries and footprints). You may provide a STR or
LIST[STR] of STILT id's or the 'result' of a .find() query. The properties of the returned stilt 
object is listed further below.</p>
<h4 id="id-str-liststr">id = STR | LIST[STR]</h4>
<p>Provide a string or list of strings representing a STILT station id's.</p>
<h4 id="id-dict-listdict">id = DICT | LIST[DICT]</h4>
<p>provide a single dictionary, or a list of dictionaries. The dictionaries should be the result of a stiltstation.find() execution.</p>
<h4 id="progress-bool_1">progress = BOOL</h4>
<p>By default no progress bar is displayed while assembling the stiltstation object. With this keyword you can show/hide the progress bar. This parameter is only effective while providing id's.</p>
<pre><code># return stilt stations based on stiltstation.find(id='STR')
stiltstation.get('HTM')         
stiltstation.get(['KIT','HTM150'], progress = True)

# return stilt stations based on dictionary or list of dict with a progressbar
a = stiltstation.find(search='north')
stiltstation.get(a)
OR
stiltstation.get(stiltstation.find(search='south'))
</code></pre>
<h3 id="stilt-object">STILT Object</h3>
<p>classmethod <strong>StiltStation(dict)</strong><br>
Please do not use this class directly. You should load <code>from icoscp.stilt import stiltstation</code> 
and then use the function <code>obj = stiltstation.get('HTM150)</code> which will return a stilt station 
object. Once you have the object, the following attributes and methods are available:</p>
<h2>Attributes:</h2>

<h4 id="id">.id</h4>
<p>Return STILT station ID (e.g. 'HTM150') as string.</p>
<h4 id="locident">.locIdent</h4>
<p>String with latitude-longitude-altitude of STILT station (e.g. '35.34Nx025.67Ex00150')</p>
<h4 id="alt">.alt</h4>
<p>Station altitude (in meters above ground level)</p>
<h4 id="lat">.lat</h4>
<p>Station latitude</p>
<h4 id="lon">.lon</h4>
<p>Station longitude</p>
<h4 id="name">.name</h4>
<p>STILT station long name</p>
<h4 id="icos">.icos</h4>
<p>None | Dict. If the station is an ICOS station, a dictionary with ICOS metadata is available.</p>
<h4 id="years">.years</h4>
<p>List of years for which STILT results are available. Be aware that even if only one day is 
calculated for a year, <code>year</code> will be listed.</p>
<h4 id="info">.info</h4>
<p>Returns the diction with all metadata.</p>
<h4 id="geoinfo">.geoinfo</h4>
<p>Dictionary with geographical (country) information, if the station is within a country border.</p>
<h2>Methods:</h2>

<h4 id="get_tsstart_date-end_date-hours-columns">.get_ts(start_date, end_date, hours=[], columns=''):</h4>
<p>STILT concentration time series for a given time period, with optional selection of specific 
hours and columns. Returns time series as a <code>pandas.DataFrame</code>.</p>
<ul>
<li>start_date : STR, FLOAT/INT (Unix timestamp), datetime object<ul>
<li>start_date = '2018-01-01'</li>
</ul>
</li>
<li>end_date : STR, FLOAT/INT (Unix timestamp), datetime object<ul>
<li>end_date = '2018-01-31'</li>
</ul>
</li>
<li>
<p>hours : STR | INT, optional. If hours is empty or None, ALL Timeslots are returned. For 
  backwards compatibility, input of str format hh:mm is accepted</p>
<ul>
<li>hours = [0,3,6,9,12,15,18,21]<pre><code>Valid results are returned with LOWER BOUND values.
Example:    hours = ["02:00",3,4] will return Timeslots for 0, 3
            hours = [2,3,4,5,6] will return Timeslots for 0,3 and 6
            hours = [] return ALL
            hours = ["10", "10:00", 10] returns timeslot 9
</code></pre>
</li>
</ul>
</li>
<li>
<p>columns : STR, optional</p>
<ul>
<li>Valid entries are <code>"default", "co2", "co", "rn", "wind", "latlon", "all"</code><pre><code>default:
    isodate, co2.stilt, co2.bio, co2.fuel, co2.cement, co2.background

co2
    isodate, co2.stilt, co2.bio, co2.fuel, co2.cement,
    co2.bio.gee, co2.bio.resp, co2.fuel.coal, co2.fuel.oil, co2.fuel.gas,
    co2.fuel.bio, co2.fuel.waste, co2.energy, co2.transport, co2.industry,
    co2.residential, co2.other_categories, co2.background

co
    isodate, co.stilt, co.fuel, co.cement, 
    co.fuel.coal, co.fuel.oil, co.fuel.gas, 
    co.fuel.bio, co.fuel.waste, co.energy
    co.transport, co.industry, co.residential, 
    co.other_categories, co.background

rn
    isodate, rn, rn.era, rn.noah

wind
    isodate, wind.dir, wind.u, wind.v

latlon
    isodate, latstart, lonstart

all
    isodate, co2.stilt, co2.bio, co2.fuel, co2.cement, 
    co2.bio.gee, co2.bio.resp, 
    co2.fuel.coal, co2.fuel.oil, co2.fuel.gas, 
    co2.fuel.bio, co2.fuel.waste, 
    co2.energy, co2.transport, co2.industry,
    co2.residential, co2.other_categories,
    co2.background,
    co.stilt, co.fuel, co.cement,
    co.fuel.coal, co.fuel.oil, co.fuel.gas,
    co.fuel.bio, co.fuel.waste, 
    co.energy, co.transport, co.industry,
    co.residential, co.other_categories,
    co.background,
    rn, rn.era, rn.noah, wind.dir,
    wind.u, wind.v, latstart, lonstart
</code></pre>
</li>
</ul>
</li>
</ul>
<h4 id="get_fpstart_date-end_date-hours">.get_fp(start_date, end_date, hours=[]):</h4>
<p>STILT footprints for a given time period, with optional selection of specific hours.
<code>Returns</code> the footprints as <code>xarray</code> 
<a href="http://xarray.pydata.org/en/stable/">http://xarray.pydata.org/en/stable/</a> with latitude, 
longitude, time, and ppm per (micromole m-2 s-1).</p>
<ul>
<li>start_date : STR, FLOAT/INT (Unix timestamp), datetime object.<ul>
<li>start_date = '2018-01-01'</li>
</ul>
</li>
<li>end_date : STR, FLOAT/INT (Unix timestamp), datetime object.<ul>
<li>end_date = '2018-01-31'</li>
</ul>
</li>
<li>hours : STR | INT, optional. If hours is empty or None, ALL Timeslots are returned. For 
  backwards compatibility, input of str format hh:mm is accepted<ul>
<li>hours = [0,3,6,9,12,15,18,21]<pre><code>Valid results are returned with LOWER BOUND values.
Example:    hours = ["02:00",3,4] will return Timeslots for 0, 3
            hours = [2,3,4,5,6] will return Timeslots for 0,3 and 6
            hours = [] return ALL
            hours = ["10", "10:00", 10] returns timeslot 9
</code></pre>
</li>
</ul>
</li>
</ul>
<hr>

<h2 id="sparql">Sparql</h2>
<p>At the ICOS Carbon Portal we store all data and metadata as linked data in a triple store. For 
more information about this approach refer to 
<a href="https://www.w3.org/standards/semanticweb/">Semantic Web</a>, 
<a href="https://www.w3.org/RDF/">Resource Description Framework (RDF)</a>, and 
<a href="https://en.wikipedia.org/wiki/Triplestore">Triple Stores</a>.</p>
<p>This module is a simple interface to the 
<a href="https://meta.icos-cp.eu/sparqlclient/?type=CSV">SPARQL endpoint</a> at the Carbon Portal. You can 
write your own queries and use the module to query the database or use some of the provided 
built-in queries. </p>
<p>Load the module with:<br>
<code>from icoscp.sparql.runsparql import RunSparql</code></p>
<p>classmethod <strong>RunSparql(sparql_query='', output_format='txt')</strong><br>
sparql_query needs to be a valid query. You can test a query directly at the online SPARQL 
endpoint at 
<a href="https://meta.icos-cp.eu/sparqlclient/?type=CSV">https://meta.icos-cp.eu/sparqlclient/?type=CSV</a>.
The output format is by default (txt/json) but you can adjust with the following formats ['json',
'csv', 'dict', 'pandas', 'array', 'html'].</p>
<h2>Attributes:</h2>
<hr>

<h3 id="runsparqldata"><strong>RunSparql.data</strong></h3>
<p>If a query is set and the method .run() was executed, it returns the result from the SPARQL 
endpoint. If no data is available the method returns False (BOOL).</p>
<ul>
<li>Return BOOL | STR</li>
</ul>
<h3 id="runsparqlquery-query"><strong>RunSparql.query = 'query'</strong></h3>
<p>Retrieve or set the query.</p>
<ul>
<li>Return STR</li>
</ul>
<h3 id="runsparqlformat-fmt"><strong>RunSparql.format = 'fmt'</strong></h3>
<p>Retrieve or set the output format.</p>
<pre><code>fmt = 'json', 'csv', 'dict', 'pandas', 'array', 'html'
</code></pre>
<ul>
<li>Return STR</li>
</ul>
<h3 id="runsparqlrun"><strong>RunSparql.run()</strong></h3>
<p>This method actually executes the query and formats the result to the output format. If the 
sparql query is not executable because of syntax errors, for example, a TUPLE is returned 
(False, 'Bad Request')</p>
<ul>
<li>Return TUPLE | FMT</li>
</ul>
<h2 id="country">Country</h2>
<p>Search country information, define global (to icoscp) a common tool to search for country 
information based on a static local file within the library (<code>country.json</code>). Search is 
facilitated through Alphanumeric 2 &amp; 3 Code characters and arbitrary text search. Credit to<br />
<a href="https://github.com/mledoze/countries">https://github.com/mledoze/countries</a>. Further a reverse 
geocoder search is provided through OSM. (credit to 
<a href="https://nominatim.openstreetmap.org">https://nominatim.openstreetmap.org</a>). </p>
<p>Please note: in case you provide more than one parameter, the order of keywords is not 
respected. The execution order is always like the function signature and as soon as a result is 
found, it will be returned and the search is stopped.</p>
<h3 id="countrygetkwargs">country.get(**kwargs)</h3>
<p>Accepted keywords: code='', name='', latlon=[], search=''</p>
<pre><code>Examples:
.get()                      list of dict: all countries
.get(code='CH')             dict: Switzerland
.get(name='greece')         dict: Greece
.get(latlon=[48.85, 2.35])  dict:
.get(search='europe')
</code></pre>
<h4 id="parameters">Parameters</h4>
<pre><code>code : STR
    Search by ISO 3166-1 2-letter or 3-letter country codes

name : STR
    search by country name, including alternativ spellings.
    It can be the native name or a partial name.

latlon : List[]
    List with two integer or floating point numbers representing
    latitude and longitude. BE AWARE: using an external service
    from openstreetmap for reverse geocoding

search : STR
    arbitrary text search, not case sensitiv, search in all fields
</code></pre>
<h4 id="returns">Returns</h4>
<ul>
<li>DICT: if a single country is found</li>
<li>LIST[DICT]: list of dictionaries if more than one country is found</li>
<li>BOOL (False) if no result</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../install/" class="btn btn-neutral float-left" title="Installation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../examples/" class="btn btn-neutral float-right" title="Examples">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../install/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../examples/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
